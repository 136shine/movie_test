var mysql = require('mysql');

function connectServer(){
    var client=mysql.createConnection({
        host:'localhost',
        user:'root',
        password:'root',
        database:'movie'
    });
    
    return client;
}

// function insertFun(client ,i,img,title,grade,callback){
//      client.query('insert into tb_movie value(?,?,?,?)', [i,title,grade,img], function(err,result){
//          if( err ){ 
//              console.log( "error:" + err.message);
//              return err;
//          }
//            callback(err);
//      });
// }

function insertFun1(client,id,title,img,grade,callback){
     client.query('insert into tb_movie(movie_id,movie_name,pic,grade) value(?,?,?,?)', [id,title,img,grade], function(err,result){
         if( err ){ 
             console.log( "error:" + err.message);
             return err;
         }
           callback(err);
     });
}

function insertFun2(client,id,director,actors,describle,time,callback){
     client.query('insert into tb_movie_detail(movie_id,director,actors,describle,time) value(?,?,?,?,?)', [id,director,actors,describle,time], function(err,result){
         if( err ){ 
             console.log( "error:" + err.message);
             return err;
         }
           callback(err);
     });
}

// function insertFun3(client,title,author,avator,pic,content,callback){
//      client.query('insert into tb_comment(title,author,avator,pic,content) value(?,?,?,?,?)', [title,author,avator,pic,content], function(err,result){
//          if( err ){ 
//              console.log( "error:" + err.message);
//              return err;
//          }
//            callback(err);
//      });
// }
function insertFun3(client,title,author,avator,pic,movie_name,content,time,callback){
     client.query('insert into tb_comment(title,author,avator,pic,movie_name,content,time) value(?,?,?,?,?,?,?)', [title,author,avator,pic,movie_name,content,time], function(err,result){
         if( err ){ 
             console.log( "error:" + err.message);
             return err;
         }
           callback(err);
     });
}
function insertFun4(client,singer,music_name,movie_name,time_long,pic,content,url,callback){
     client.query('insert into tb_music(singer,music_name,movie_name,time_long,pic,content,url) value(?,?,?,?,?,?,?)', [singer,music_name,movie_name,time_long,pic,content,url], function(err,result){
         if( err ){ 
             console.log( "error:" + err.message);
             return err;
         }
           callback(err);
     });
}

exports.connect = connectServer;
exports.insertFun1 = insertFun1;
exports.insertFun2 = insertFun2;
exports.insertFun3 = insertFun3;
exports.insertFun4 = insertFun4;